# SCR201 管理ダッシュボード（簡易トップ）画面設計書

---

## 1. 画面概要

### 1.1 画面の目的

管理者がシステム全体の概況（ユーザ数、講座数、売上状況など）と、  
主要な管理機能（講座管理・注文管理）への導線をひと目で把握できることを目的とする。

- 日次・月次レベルの売上や注文件数のサマリを確認
- システム全体の「今の状態」を俯瞰
- 詳細管理画面（講座・動画管理／注文・売上一覧）へのハブとして機能

### 1.2 利用者ロール

| ロールID | ロール名   | 権限概要                   |
|----------|------------|----------------------------|
| R001     | 管理者     | 全情報の閲覧が可能         |
| R002     | 運営担当   | 閲覧のみ（一部リンク利用） |

※ ダッシュボード上での更新操作は行わない想定。

### 1.3 関連機能・関連API

| 種別 | ID       | 名称                              | 用途                                  |
|------|----------|-----------------------------------|---------------------------------------|
| 機能 | F201     | ダッシュボード表示               | 本画面の表示                          |
| 機能 | F202     | サマリーカード表示               | ユーザ数／講座数／本日売上などを表示 |
| 機能 | F203     | 最近の注文一覧表示               | 直近の注文情報を一覧表示             |
| 機能 | F204     | ショートカットリンク             | 講座管理／注文管理画面への遷移       |
| API  | API201   | get_admin_dashboard_summary      | サマリー情報取得                      |
| API  | API202   | list_recent_orders_for_dashboard | 最近の注文取得（件数は限定）         |

---

## 2. 画面レイアウト設計（UI仕様）

### 2.1 ワイヤーフレーム（テキスト説明）

- 上部：ページヘッダ
  - タイトル：「管理ダッシュボード」
  - パンくず：「管理トップ > ダッシュボード」（任意）
- 上部中段：サマリーカードエリア（横4枚程度）
  - 総ユーザ数
  - 総講座数
  - 本日の注文数
  - 本日の売上合計
- 中央：最近の注文一覧テーブル
  - 注文日時
  - ユーザ名（メール）
  - 講座名
  - 金額
  - 支払ステータス
- 右上または下部：ショートカットエリア
  - 「講座・動画管理へ」ボタン（SCR202へ）
  - 「注文・売上一覧へ」ボタン（SCR203へ）

### 2.2 UIコンポーネント一覧

| UI ID  | コンポーネント種類 | ラベル                | 説明                                |
|--------|---------------------|-----------------------|-------------------------------------|
| UI201  | Text                | 画面タイトル          | 「管理ダッシュボード」             |
| UI202  | Card                | 総ユーザ数カード      | 登録ユーザ数を表示                  |
| UI203  | Card                | 総講座数カード        | 登録講座数を表示                    |
| UI204  | Card                | 本日の注文数カード    | 当日注文件数                        |
| UI205  | Card                | 本日の売上合計カード  | 当日売上金額                        |
| UI206  | Table               | 最近の注文一覧        | 直近N件の注文を表示                 |
| UI207  | Button              | 講座・動画管理へ      | SCR202 への遷移                     |
| UI208  | Button              | 注文・売上一覧へ      | SCR203 への遷移                     |

---

## 3. 画面項目定義（Field Definition）

### 3.1 入力項目一覧

本画面は検索条件や入力フォームを持たないため、「入力項目」はなし。

| No | UI ID | 項目名 | 型 | 必須 | 桁数 | バリデーション | 備考 |
|----|-------|--------|----|------|------|----------------|------|
| -  | -     | -      | -  | -    | -    | -              | -    |

### 3.2 表示項目一覧（サマリー＋テーブル）

#### サマリーカード

| No | UI ID | 表示名         | DB項目／算出項目                | 型      | 備考                        |
|----|-------|----------------|---------------------------------|---------|-----------------------------|
| 1  | UI202 | 総ユーザ数     | COUNT(T_USER.user_id)           | integer | 有効ユーザのみ対象          |
| 2  | UI203 | 総講座数       | COUNT(T_COURSE.course_id)       | integer | 公開／非公開問わず          |
| 3  | UI204 | 本日の注文数   | COUNT(T_ORDER.order_id WHERE order_date = today) | integer | 成功ステータスのみ集計     |
| 4  | UI205 | 本日の売上合計 | SUM(T_ORDER.amount WHERE order_date = today)   | integer | 税込金額／キャンセル除外   |

#### 最近の注文一覧テーブル

| No | UI ID | 表示名       | DB項目                    | 型      | 備考                    |
|----|-------|--------------|---------------------------|---------|-------------------------|
| 1  | UI206 | 注文ID       | T_ORDER.order_id          | int     |                         |
| 2  | UI206 | 注文日時     | T_ORDER.ordered_at        | datetime|                         |
| 3  | UI206 | ユーザメール | T_USER.email              | string  | JOIN により取得         |
| 4  | UI206 | 講座名       | T_COURSE.course_name      | string  | JOIN により取得         |
| 5  | UI206 | 金額         | T_ORDER.amount            | integer |                         |
| 6  | UI206 | ステータス   | T_ORDER.status            | string  | 例：成功／失敗／返金 等 |

---

## 4. イベント処理定義（Event & Transition）

### 4.1 ボタン／イベント一覧

| イベントID | トリガー                | 説明                             | 呼び出すAPI | 遷移先            |
|------------|-------------------------|----------------------------------|-------------|-------------------|
| EVT201     | 画面初期表示           | ダッシュボード用サマリ取得       | API201,202  | 画面内更新        |
| EVT202     | 「講座・動画管理」押下 | 講座・動画管理画面へ遷移         | なし        | SCR202            |
| EVT203     | 「注文・売上一覧」押下 | 注文・売上一覧画面へ遷移         | なし        | SCR203            |

### 4.2 画面状態遷移

- 状態A：初期表示（ロード中）
- 状態B：データ取得成功（サマリ／一覧表示）
- 状態C：データ取得失敗（エラーメッセージ表示）

---

## 5. エラー・メッセージ設計

### 5.1 入力エラー

- 入力項目がないため該当なし。

### 5.2 業務エラー

| メッセージID | 内容                                  | 発生条件                         |
|--------------|---------------------------------------|----------------------------------|
| MSG201       | ダッシュボード情報の取得に失敗しました。 | API201 もしくは API202 失敗時   |
| MSG202       | 最近の注文はありません。              | 最近の注文データ 0 件時          |

---

## 6. APIインターフェース仕様（画面→API）

### 6.1 リクエスト（API201: get_admin_dashboard_summary）

| パラメータ | 型  | 必須 | 説明       |
|------------|-----|------|------------|
| -          | -   | -    | なし       |

### 6.2 レスポンス（API201）

| フィールド         | 型      | 説明           |
|--------------------|---------|----------------|
| total_users        | integer | 総ユーザ数     |
| total_courses      | integer | 総講座数       |
| today_order_count  | integer | 本日の注文数   |
| today_sales_amount | integer | 本日の売上合計 |

### 6.3 リクエスト（API202: list_recent_orders_for_dashboard）

| パラメータ | 型      | 必須 | 説明                     |
|------------|---------|------|--------------------------|
| limit      | integer | 任意 | 取得件数（デフォルト10） |

---

## 7. 権限・操作制御（RBAC）

### 7.1 操作権限表

| ロール   | 閲覧 | 登録 | 更新 | 削除 | 帳票出力 |
|----------|------|------|------|------|----------|
| 管理者   | ○    | ×    | ×    | ×    | ×        |
| 運営担当 | ○    | ×    | ×    | ×    | ×        |

---

## 8. 帳票設計（Report Design）

本画面から直接帳票出力は行わない想定。

| 帳票ID | 帳票名 | 出力形式 | 出力トリガー | 備考 |
|--------|--------|----------|--------------|------|
| -      | -      | -        | -            | -    |

---

## 9. 対応DB（参照／更新）

| テーブルID | テーブル名     | 使用用途         | 備考 |
|-----------|----------------|------------------|------|
| T_USER    | ユーザマスタ   | 総ユーザ数集計   | 参照 |
| T_COURSE  | 講座マスタ     | 総講座数集計     | 参照 |
| T_ORDER   | 注文テーブル   | 注文数・売上集計 | 参照 |

---

## 10. 非機能（画面観点）

| 項目           | 内容                          |
|----------------|-------------------------------|
| 表示応答時間   | 3秒以内（サマリ＋一覧取得）   |
| 最大表示件数   | 最近の注文は最大 20 件表示    |

---

## 11. 前提・制約

- 本画面は管理権限を持つユーザのみアクセス可能（認可は別途仕様）。
- サマリ／一覧の集計ロジックはバックエンドで実装する。
- タイムゾーンは日本時間（JST）で統一。

---
