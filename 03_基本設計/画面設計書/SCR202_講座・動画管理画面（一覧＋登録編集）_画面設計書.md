# SCR202 講座・動画管理画面（一覧＋登録/編集）画面設計書

---

## 1. 画面概要

### 1.1 画面の目的

管理者が講座および紐づく動画を一覧・検索・登録・編集できるようにする。

- 講座の基本情報（タイトル／価格／公開状態／カテゴリ）の管理
- 講座に紐づく動画（カリキュラム）の登録・編集・並び順変更
- 公開・非公開の切り替え

### 1.2 利用者ロール

| ロールID | ロール名   | 権限概要                         |
|----------|------------|----------------------------------|
| R001     | 管理者     | 全機能利用可（登録／更新／削除） |
| R002     | 運営担当   | 一部項目の編集のみ               |

### 1.3 関連機能・関連API

| 種別 | ID       | 名称                                  | 用途                                    |
|------|----------|---------------------------------------|-----------------------------------------|
| 機能 | F301     | 講座一覧表示                         | 講座の検索・一覧表示                    |
| 機能 | F302     | 講座登録／編集                       | 講座の新規登録・更新                    |
| 機能 | F303     | 動画一覧表示（講座単位）             | 選択した講座の動画一覧表示              |
| 機能 | F304     | 動画登録／編集／並び順変更           | 講座に紐づく動画の管理                  |
| 機能 | F305     | 公開／非公開切り替え                 | 公開状態切替                            |
| API  | API301   | search_courses                        | 講座一覧検索                            |
| API  | API302   | get_course_detail_for_admin           | 管理用講座詳細取得                      |
| API  | API303   | save_course                           | 講座登録・更新                          |
| API  | API304   | list_videos_by_course                 | 指定講座の動画一覧取得                  |
| API  | API305   | save_video                            | 動画登録・更新                          |
| API  | API306   | update_video_order                    | 動画の並び順更新                        |

---

## 2. 画面レイアウト設計（UI仕様）

### 2.1 ワイヤーフレーム（テキスト説明）

- 上部：検索条件エリア
  - 講座名（部分一致）
  - カテゴリ
  - 公開状態（公開／非公開）
  - 検索ボタン／クリアボタン
- 中央左：講座一覧テーブル
  - 講座ID
  - 講座名
  - カテゴリ
  - 価格
  - 公開状態
  - 編集ボタン
- 中央右（または下部）：詳細・編集パネル
  - 選択中の講座詳細
  - 基本情報編集フォーム
  - 公開状態切替
  - 「保存」ボタン
- 下部：動画管理エリア
  - 動画一覧（タイトル／時間／並び順）
  - 新規動画追加ボタン
  - 動画編集モーダル（タイトル／説明／動画URL or ストレージキー／時間／並び順）

### 2.2 UIコンポーネント一覧

| UI ID  | コンポーネント種類 | ラベル               | 説明                           |
|--------|---------------------|----------------------|--------------------------------|
| UI301  | TextBox             | 講座名（検索）       | 部分一致検索                   |
| UI302  | Dropdown            | カテゴリ（検索）     | カテゴリマスタから選択         |
| UI303  | Dropdown            | 公開状態（検索）     | 公開／非公開                   |
| UI304  | Button              | 検索                 | 講座一覧を再取得               |
| UI305  | Button              | クリア               | 検索条件のリセット             |
| UI306  | Table               | 講座一覧             | 検索結果の表示                 |
| UI307  | Button              | 新規講座登録         | 空の講座編集フォームを表示     |
| UI308  | Form                | 講座編集フォーム     | タイトル／価格／公開状態など   |
| UI309  | Button              | 講座保存             | 講座情報の保存                 |
| UI310  | Table / List        | 動画一覧             | 選択講座の動画リスト           |
| UI311  | Button              | 新規動画追加         | 動画編集モーダルを開く         |
| UI312  | Modal Form          | 動画編集フォーム     | 動画の登録・編集               |
| UI313  | Button              | 並び順保存           | 並び順更新（ドラッグ&ドロップ）|

---

## 3. 画面項目定義（Field Definition）

### 3.1 入力項目一覧

#### 検索条件

| No | UI ID | 項目名       | 型     | 必須 | 桁数 | バリデーション       | 備考        |
|----|-------|--------------|--------|------|------|----------------------|-------------|
| 1  | UI301 | 講座名（検索）| string | 任意 | 100  | 文字列               | 部分一致    |
| 2  | UI302 | カテゴリ     | string | 任意 | 50   | マスタ値             |             |
| 3  | UI303 | 公開状態     | string | 任意 | 10   | '公開' or '非公開'等 |             |

#### 講座編集フォーム

| No | UI ID | 項目名       | 型     | 必須 | 桁数 | バリデーション       | 備考                |
|----|-------|--------------|--------|------|------|----------------------|---------------------|
| 4  | UI308 | 講座タイトル | string | 必須 | 200  | 未入力禁止           |                     |
| 5  | UI308 | サブタイトル | string | 任意 | 200  |                      |                     |
| 6  | UI308 | カテゴリ     | string | 任須 | 50   | マスタ値             |                     |
| 7  | UI308 | 価格         | int    | 必須 | -    | 数値、0以上           | 税込 or 税抜 定義   |
| 8  | UI308 | 公開状態     | string | 必須 | 10   | '公開' or '非公開'等 |                     |

#### 動画編集フォーム（UI312）

| No | UI ID | 項目名       | 型     | 必須 | 桁数 | バリデーション           | 備考                    |
|----|-------|--------------|--------|------|------|--------------------------|-------------------------|
| 9  | UI312 | 動画タイトル | string | 必須 | 200  | 未入力禁止               |                         |
| 10 | UI312 | 説明文       | string | 任意 | 1000 |                          |                         |
| 11 | UI312 | 動画URL      | string | 必須 | 500  | URL形式                  | ストレージキーでも可    |
| 12 | UI312 | 再生時間     | int    | 必須 | -    | 0以上の数値（秒または分）|                         |
| 13 | UI312 | 並び順       | int    | 任意 | -    | 1以上の整数              | ドラッグ&ドロップでも可 |

### 3.2 表示項目一覧（テーブル欄）

#### 講座一覧（UI306）

| No | UI ID | 表示名     | DB項目              | 型      | 備考                         |
|----|-------|------------|---------------------|---------|------------------------------|
| 1  | UI306 | 講座ID     | T_COURSE.course_id  | int     |                              |
| 2  | UI306 | 講座名     | T_COURSE.course_name| string  |                              |
| 3  | UI306 | カテゴリ   | T_COURSE.category   | string  |                              |
| 4  | UI306 | 価格       | T_PRODUCT.price     | integer |                              |
| 5  | UI306 | 公開状態   | T_COURSE.status     | string  | '公開'／'非公開' 等          |

#### 動画一覧（UI310）

| No | UI ID | 表示名       | DB項目              | 型      | 備考              |
|----|-------|--------------|---------------------|---------|-------------------|
| 6  | UI310 | 動画ID       | T_VIDEO.video_id    | int     |                   |
| 7  | UI310 | 動画タイトル | T_VIDEO.title       | string  |                   |
| 8  | UI310 | 再生時間     | T_VIDEO.duration    | int     | 秒または分        |
| 9  | UI310 | 並び順       | T_VIDEO.sort_order  | int     | 小さいほど先頭    |

---

## 4. イベント処理定義（Event & Transition）

### 4.1 ボタン／イベント一覧

| イベントID | トリガー                          | 説明                               | 呼び出すAPI | 遷移先  |
|------------|-----------------------------------|------------------------------------|-------------|---------|
| EVT301     | 検索ボタン押下                   | 検索条件に基づき講座一覧取得       | API301      | 画面内  |
| EVT302     | クリアボタン押下                 | 検索条件リセット + 再検索          | API301      | 画面内  |
| EVT303     | 講座一覧行クリック／編集押下     | 対象講座の詳細情報を読み込み       | API302      | 画面内  |
| EVT304     | 新規講座登録ボタン押下           | 空の講座編集フォーム表示           | なし        | 画面内  |
| EVT305     | 講座保存ボタン押下               | フォーム内容を保存                 | API303      | 画面内  |
| EVT306     | 動画一覧表示（講座選択）         | 講座に紐づく動画一覧取得           | API304      | 画面内  |
| EVT307     | 新規動画追加ボタン押下           | 動画編集モーダル表示               | なし        | 画面内  |
| EVT308     | 動画保存ボタン押下               | 動画情報保存                       | API305      | 画面内  |
| EVT309     | 動画並び順操作（D&D等）＋保存押下 | 並び順情報更新                     | API306      | 画面内  |

### 4.2 画面状態遷移

- 状態A：初期表示（検索条件空＋講座一覧表示）
- 状態B：講座選択済み＋編集フォーム表示
- 状態C：動画一覧ロード済み
- 状態D：エラー表示状態（APIエラー等）

---

## 5. エラー・メッセージ設計

### 5.1 入力エラー

| メッセージID | 内容                               | 表示タイミング                   |
|--------------|------------------------------------|----------------------------------|
| MSG301       | 講座タイトルを入力してください。   | 講座保存時、タイトル未入力      |
| MSG302       | 価格は0以上の数値で入力してください。 | 価格が不正（負数／数値変換失敗） |
| MSG303       | 動画タイトルを入力してください。   | 動画保存時、タイトル未入力      |
| MSG304       | 動画URLの形式が不正です。          | URL形式チェックNG               |

### 5.2 業務エラー

| メッセージID | 内容                          | 発生条件                        |
|--------------|-------------------------------|---------------------------------|
| MSG305       | 講座情報の取得に失敗しました。 | API302失敗                      |
| MSG306       | 講座情報の保存に失敗しました。 | API303失敗                      |
| MSG307       | 動画情報の取得に失敗しました。 | API304失敗                      |
| MSG308       | 動画情報の保存に失敗しました。 | API305失敗                      |
| MSG309       | 動画の並び順更新に失敗しました。 | API306失敗                     |

---

## 6. APIインターフェース仕様（画面→API）

### 6.1 リクエスト（API301: search_courses）

| パラメータ | 型     | 必須 | 説明       |
|------------|--------|------|------------|
| name       | string | 任意 | 講座名     |
| category   | string | 任意 | カテゴリ   |
| status     | string | 任意 | 公開状態   |

### 6.2 レスポンス（API301）

- 講座一覧（3.2参照）

### 6.3 リクエスト（API303: save_course）

| パラメータ | 型   | 必須 | 説明                   |
|------------|------|------|------------------------|
| course_id  | int  | 任意 | 更新時のみ必須         |
| name       | string | 必須 | 講座名                |
| subtitle   | string | 任意 | サブタイトル          |
| category   | string | 必須 | カテゴリ              |
| price      | int  | 必須 | 価格                   |
| status     | string | 必須 | 公開状態              |

（他APIは略記：概ね 3.1/3.2 の項目に対応）

---

## 7. 権限・操作制御（RBAC）

### 7.1 操作権限表

| ロール   | 閲覧 | 登録 | 更新 | 削除 | 帳票出力 |
|----------|------|------|------|------|----------|
| 管理者   | ○    | ○    | ○    | ○    | ×        |
| 運営担当 | ○    | ○    | ○    | ×    | ×        |

---

## 8. 帳票設計（Report Design）

本画面から直接の帳票出力は行わない。

| 帳票ID | 帳票名 | 出力形式 | 出力トリガー | 備考 |
|--------|--------|----------|--------------|------|
| -      | -      | -        | -            | -    |

---

## 9. 対応DB（参照／更新）

| テーブルID | テーブル名     | 使用用途        | 備考 |
|-----------|----------------|-----------------|------|
| T_COURSE  | 講座マスタ     | 講座情報の参照・更新 | 更新 |
| T_VIDEO   | 動画マスタ     | 動画情報の参照・更新 | 更新 |
| T_PRODUCT | 商品マスタ     | 価格情報の参照・更新 | 更新 |

---

## 10. 非機能（画面観点）

| 項目           | 内容                        |
|----------------|-----------------------------|
| 表示応答時間   | 検索結果表示 3秒以内       |
| 最大表示件数   | 講座一覧 100件／ページ程度 |

---

## 11. 前提・制約

- 動画ファイルの実体のアップロード処理は別画面 or 別システムで管理する可能性あり（ここではURL／キーのみ）。
- 価格は税抜／税込のどちらかを別途決定し、ラベルで明示する。

---
