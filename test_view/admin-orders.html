<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>注文・売上一覧 | 美容オンラインアカデミー 管理画面</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --color-bg: #f4f5fb;
      --color-surface: #ffffff;
      --color-primary: #e91e63;
      --color-primary-dark: #c2185b;
      --color-accent: #3f51b5;
      --color-text: #333333;
      --color-muted: #777777;
      --shadow-soft: 0 4px 12px rgba(0, 0, 0, 0.06);
      --radius-lg: 12px;
      --radius-full: 999px;
      --max-width: 1200px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: var(--color-bg);
      color: var(--color-text);
      line-height: 1.6;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    .page-wrap {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    main { flex: 1; }

    .container {
      width: 100%;
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 16px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 16px;
      border-radius: var(--radius-full);
      border: 1px solid transparent;
      font-size: 13px;
      cursor: pointer;
      background: transparent;
      color: var(--color-text);
      transition: background 0.15s ease, color 0.15s ease, box-shadow 0.15s ease,
        border-color 0.15s ease, transform 0.05s ease;
      text-decoration: none;
      white-space: nowrap;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-soft);
    }

    .btn-primary {
      background: var(--color-primary);
      color: #ffffff;
    }
    .btn-primary:hover {
      background: var(--color-primary-dark);
    }

    .btn-secondary {
      border-color: #dddddd;
      background: #ffffff;
    }

    .btn-muted {
      border-color: #e0e0e7;
      background: #f5f5fa;
      color: var(--color-muted);
      font-size: 12px;
      padding: 6px 10px;
    }

    .btn-ghost {
      border-color: transparent;
      background: transparent;
      color: var(--color-muted);
      padding: 6px 6px;
      font-size: 12px;
    }

    .btn-icon {
      padding: 4px 8px;
      font-size: 12px;
    }

    /* 管理用ヘッダー（他管理画面と共通トーン） */

    .header {
      position: sticky;
      top: 0;
      z-index: 10;
      background: #1f2230;
      color: #ffffff;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.25);
    }

    .header-inner {
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-admin {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      font-size: 18px;
    }

    .service-name {
      font-weight: 600;
      font-size: 15px;
    }

    .service-badge {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: var(--radius-full);
      background: rgba(255, 255, 255, 0.1);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 12px;
    }

    .header-username {
      opacity: 0.9;
    }

    .header-role {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: var(--radius-full);
      background: rgba(0, 0, 0, 0.3);
    }

    .btn-logout {
      border-color: rgba(255, 255, 255, 0.5);
      color: #ffffff;
      background: transparent;
      font-size: 12px;
      padding: 6px 12px;
    }

    .btn-logout:hover {
      background: rgba(255, 255, 255, 0.08);
    }

    /* ページヘッダ */

    .page-header {
      padding: 16px 0 8px;
    }

    .breadcrumb {
      font-size: 11px;
      color: var(--color-muted);
      margin-bottom: 4px;
    }

    .breadcrumb a {
      color: var(--color-muted);
    }

    .breadcrumb a:hover {
      color: var(--color-primary);
    }

    .breadcrumb-sep {
      margin: 0 4px;
    }

    .page-title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .page-title {
      font-size: 20px;
      font-weight: 600;
    }

    .page-sub {
      font-size: 12px;
      color: var(--color-muted);
    }

    /* カード共通 */

    .card {
      background: var(--color-surface);
      border-radius: 14px;
      padding: 12px 14px 12px;
      box-shadow: var(--shadow-soft);
      font-size: 13px;
    }

    .card-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 600;
    }

    .card-sub {
      font-size: 11px;
      color: var(--color-muted);
    }

    /* 検索＋サマリエリア（上部） */

    .search-summary-section {
      padding: 4px 0 10px;
    }

    .search-summary-layout {
      display: grid;
      grid-template-columns: minmax(0, 2.3fr) minmax(260px, 1.2fr);
      gap: 12px;
      align-items: flex-start;
    }

    .search-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 8px;
    }

    .form-field {
      display: flex;
      flex-direction: column;
      gap: 3px;
      font-size: 12px;
    }

    .form-label {
      font-size: 11px;
      color: var(--color-muted);
    }

    .form-control {
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid #d4d4e0;
      font-size: 13px;
      background: #ffffff;
    }

    .search-actions {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 4px;
    }

    .error-message {
      font-size: 11px;
      color: #c62828;
      min-height: 16px;
    }

    .summary-card {
      background: var(--color-surface);
      border-radius: 14px;
      padding: 10px 12px;
      box-shadow: var(--shadow-soft);
      font-size: 13px;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .summary-item-label {
      font-size: 11px;
      color: var(--color-muted);
    }

    .summary-item-value {
      font-size: 16px;
      font-weight: 600;
    }

    .summary-item-note {
      font-size: 11px;
      color: var(--color-muted);
    }

    /* 注文一覧テーブル */

    .orders-section {
      padding-bottom: 20px;
    }

    .table-wrapper {
      width: 100%;
      overflow-x: auto;
    }

    .orders-table {
      width: 100%;
      font-size: 12px;
    }

    .orders-table th,
    .orders-table td {
      padding: 6px 8px;
      border-bottom: 1px solid #f0f0f5;
      text-align: left;
      white-space: nowrap;
    }

    .orders-table th {
      font-size: 11px;
      color: var(--color-muted);
      background: #fafafe;
    }

    .orders-table tbody tr:hover {
      background: #fafafa;
    }

    .col-order-id { width: 80px; }
    .col-order-datetime { width: 150px; }
    .col-user-email { width: 210px; }
    .col-course-name { min-width: 200px; }
    .col-amount { width: 90px; text-align: right; }
    .col-status { width: 80px; }

    .status-pill {
      display: inline-flex;
      align-items: center;
      padding: 2px 8px;
      border-radius: var(--radius-full);
      font-size: 11px;
    }

    .status-success {
      background: #e3ffe7;
      color: #2e7d32;
      border: 1px solid #b5f0c2;
    }

    .status-failed {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #ef9a9a;
    }

    .status-refund {
      background: #fff3e0;
      color: #e65100;
      border: 1px solid #ffcc80;
    }

    .empty-state {
      padding: 14px 10px;
      font-size: 13px;
      color: var(--color-muted);
    }

    .empty-state strong {
      color: var(--color-text);
    }

    /* 下部：CSV出力＋ページング */

    .orders-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-top: 8px;
      font-size: 11px;
      color: var(--color-muted);
    }

    .paging-info {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .paging-controls {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .paging-controls button {
      padding-inline: 10px;
      font-size: 11px;
    }

    /* フッター */

    .footer {
      margin-top: 24px;
      border-top: 1px solid #e0e0ea;
      background: #ffffff;
    }

    .footer-inner {
      padding: 10px 16px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-size: 11px;
      color: var(--color-muted);
    }

    .footer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .footer-links a {
      color: var(--color-muted);
    }

    .footer-links a:hover {
      color: var(--color-primary);
    }

    /* レスポンシブ */

    @media (max-width: 960px) {
      .search-summary-layout {
        grid-template-columns: minmax(0, 1fr);
      }
      .search-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
      .summary-card {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 720px) {
      .search-grid {
        grid-template-columns: minmax(0, 1fr);
      }
      .header-inner {
        height: 52px;
        font-size: 13px;
      }
      .page-title-row {
        flex-direction: column;
        align-items: flex-start;
      }
      .card {
        padding: 10px 10px;
      }
      .footer-inner {
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
<div class="page-wrap">

  <!-- 管理ヘッダー -->
  <header class="header">
    <div class="container header-inner">
      <div class="header-left">
        <div class="logo-admin">B</div>
        <div>
          <div class="service-name">美容オンラインアカデミー 管理画面</div>
          <div class="service-badge">Order & Sales List</div>
        </div>
      </div>
      <div class="header-right">
        <span class="header-username">keiri@example.com</span>
        <span class="header-role">ロール：経理担当（R001）</span>
        <button type="button" class="btn btn-logout">ログアウト</button>
      </div>
    </div>
  </header>

  <main>
    <div class="container">

      <!-- ページヘッダ -->
      <section class="page-header">
        <div class="breadcrumb" aria-label="パンくずリスト">
          <a href="/admin/dashboard">管理トップ</a>
          <span class="breadcrumb-sep">›</span>
          <span>注文・売上一覧</span>
        </div>
        <div class="page-title-row">
          <div>
            <h1 class="page-title">注文・売上一覧</h1>
            <p class="page-sub">
              期間・講座・ユーザなどで絞り込み、注文履歴と売上状況を確認する画面のサンプルです。
            </p>
          </div>
          <button type="button" class="btn btn-muted">
            権限：管理者／経理担当向け
          </button>
        </div>
      </section>

      <!-- 上部：検索条件＋サマリ（F401/F403） -->
      <section class="search-summary-section">
        <div class="search-summary-layout">

          <!-- 検索条件 -->
          <section class="card" aria-label="検索条件">
            <div class="card-header">
              <div>
                <div class="card-title">検索条件</div>
                <div class="card-sub">
                  期間・ユーザメール・講座・ステータスで絞り込み可能です（API401: search_orders を想定）。
                </div>
              </div>
            </div>

            <div class="search-grid">
              <div class="form-field">
                <label class="form-label" for="dateFrom">開始日</label>
                <input id="dateFrom" class="form-control" type="date" />
              </div>
              <div class="form-field">
                <label class="form-label" for="dateTo">終了日</label>
                <input id="dateTo" class="form-control" type="date" />
              </div>
              <div class="form-field">
                <label class="form-label" for="email">ユーザメール（部分一致）</label>
                <input id="email" class="form-control" type="text" placeholder="例：@example.com" />
              </div>
              <div class="form-field">
                <label class="form-label" for="course">講座</label>
                <select id="course" class="form-control">
                  <option value="">すべて</option>
                  <option value="1">ショートカット設計の基礎と応用</option>
                  <option value="2">ダメージを抑えるブリーチ＆オンカラー設計</option>
                  <option value="3">サロン売上アップのためのカウンセリング術</option>
                </select>
              </div>
              <div class="form-field">
                <label class="form-label" for="status">ステータス</label>
                <select id="status" class="form-control">
                  <option value="">すべて</option>
                  <option value="success">成功</option>
                  <option value="failed">失敗</option>
                  <option value="refund">返金</option>
                </select>
              </div>
            </div>

            <div class="search-actions">
              <div class="error-message" id="errorArea">
                <!-- MSG401: 開始日と終了日の関係が不正です。 -->
              </div>
              <div>
                <button type="button" class="btn btn-secondary" id="btnClear">
                  クリア
                </button>
                <button type="button" class="btn btn-primary" id="btnSearch">
                  検索
                </button>
              </div>
            </div>
          </section>

          <!-- サマリ（件数＋売上合計） -->
          <aside class="summary-card" aria-label="売上サマリ">
            <div>
              <div class="summary-item-label">検索結果件数</div>
              <div class="summary-item-value" id="summaryCount">128件</div>
              <div class="summary-item-note">
                ※ ページング前の総件数（total_count）
              </div>
            </div>
            <div>
              <div class="summary-item-label">売上合計</div>
              <div class="summary-item-value" id="summaryAmount">¥1,248,600</div>
              <div class="summary-item-note">
                ※ 返金・失敗を除いた売上合計（total_amount）
              </div>
            </div>
          </aside>

        </div>
      </section>

      <!-- 中央：注文一覧テーブル（F401/F402） -->
      <section class="orders-section">
        <section class="card" aria-label="注文一覧">
          <div class="card-header">
            <div>
              <div class="card-title">注文一覧</div>
              <div class="card-sub">
                期間・条件に合致した注文が一覧表示されます。帳票出力は下部の「CSV出力」から実行します。
              </div>
            </div>
          </div>

          <div class="table-wrapper">
            <table class="orders-table" id="ordersTable">
              <thead>
              <tr>
                <th class="col-order-id">注文ID</th>
                <th class="col-order-datetime">注文日時</th>
                <th class="col-user-email">ユーザメール</th>
                <th class="col-course-name">講座名</th>
                <th class="col-amount">金額</th>
                <th class="col-status">ステータス</th>
              </tr>
              </thead>
              <tbody>
              <!-- ダミー行：本番は API401 の items を展開 -->
              <tr>
                <td>#10234</td>
                <td>2025/11/17 15:21</td>
                <td>taro.salon@example.com</td>
                <td>ショートカット設計の基礎と応用</td>
                <td class="col-amount">¥9,800</td>
                <td><span class="status-pill status-success">成功</span></td>
              </tr>
              <tr>
                <td>#10233</td>
                <td>2025/11/17 14:05</td>
                <td>staff01@abc-hair.jp</td>
                <td>ダメージを抑えるブリーチ＆オンカラー設計</td>
                <td class="col-amount">¥12,800</td>
                <td><span class="status-pill status-success">成功</span></td>
              </tr>
              <tr>
                <td>#10232</td>
                <td>2025/11/17 13:42</td>
                <td>owner@xyz-salon.jp</td>
                <td>サロン売上アップのためのカウンセリング術</td>
                <td class="col-amount">¥7,800</td>
                <td><span class="status-pill status-refund">返金</span></td>
              </tr>
              <tr>
                <td>#10231</td>
                <td>2025/11/17 12:10</td>
                <td>miho.stylist@example.com</td>
                <td>ベーシックカラーデザイン入門</td>
                <td class="col-amount">¥6,800</td>
                <td><span class="status-pill status-success">成功</span></td>
              </tr>
              <tr>
                <td>#10230</td>
                <td>2025/11/17 11:57</td>
                <td>test.user@example.com</td>
                <td>ショートカット設計の基礎と応用</td>
                <td class="col-amount">¥9,800</td>
                <td><span class="status-pill status-failed">失敗</span></td>
              </tr>
              <!-- 検索結果0件時の例：tbodyを空にし、下の empty-state を表示する運用も可 -->
              </tbody>
            </table>
          </div>

          <!-- 0件時のメッセージ例（MSG402） -->
          <!--
          <div class="empty-state">
            <strong>注文データが存在しません。</strong><br />
            検索条件を変更して再度お試しください。
          </div>
          -->

          <div class="orders-footer">
            <div class="paging-info">
              <span id="pagingSummary">全 128 件中 1〜20 件を表示</span>
              <div class="paging-controls">
                <button type="button" class="btn btn-muted btn-icon">« 前へ</button>
                <span>ページ 1 / 7</span>
                <button type="button" class="btn btn-muted btn-icon">次へ »</button>
              </div>
            </div>
            <div>
              <button type="button" class="btn btn-secondary" id="btnCsv">
                CSV出力
              </button>
            </div>
          </div>
        </section>
      </section>
    </div>
  </main>

  <!-- フッター（管理画面用簡易版） -->
  <footer class="footer">
    <div class="container footer-inner">
      <div>© 2025 Beauty Online Academy Admin Console</div>
      <div class="footer-links">
        <a href="/admin/system-info">システム情報</a>
        <a href="/admin/audit-log">監査ログ</a>
      </div>
    </div>
  </footer>

</div>

<script>
  // 簡易バリデーション＆ダミー動作：実装時は API401 / API402 と連携
  const dateFromInput = document.getElementById("dateFrom");
  const dateToInput = document.getElementById("dateTo");
  const errorArea = document.getElementById("errorArea");

  document.getElementById("btnSearch").addEventListener("click", function () {
    errorArea.textContent = "";
    const from = dateFromInput.value;
    const to = dateToInput.value;

    if (from && to && from > to) {
      // MSG401: 開始日と終了日の関係が不正です。
      errorArea.textContent = "開始日と終了日の関係が不正です。";
      return;
    }

    alert("検索条件に基づき注文一覧取得する想定（API401: search_orders）。\n\nサンプルのため画面上は変化しません。");
  });

  document.getElementById("btnClear").addEventListener("click", function () {
    dateFromInput.value = "";
    dateToInput.value = "";
    document.getElementById("email").value = "";
    document.getElementById("course").value = "";
    document.getElementById("status").value = "";
    errorArea.textContent = "";
  });

  document.getElementById("btnCsv").addEventListener("click", function () {
    alert("現在の検索条件に基づき CSV をダウンロードする想定（API402: export_orders_as_csv）。");
  });
</script>
</body>
</html>
